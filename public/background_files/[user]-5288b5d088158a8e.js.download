(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[516],{51367:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/app/users/[user]",function(){return n(47265)}])},47265:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return R}});var r=n(34051),o=n.n(r),s=n(85893),a=n(67294);var i=a.forwardRef((function(e,t){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:t},e),a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"}))})),l=n(67471),c=n(96857),u=n(44681),d=n(40169),f=n(91962),h=n(38945),m=n(1848),p=n(8639),x=n(20640),v=n.n(x),g=n(41664),b=n(11163),j=n(1852),w=n(88305),y=n(60204),N=n(36090),k=n(60670),_=n(40622),C=n(95862),Z=n(49306),O=n(93606),S=n(9281),E=n(74210),L=n(44824),A=n(95611),U=n(25482),B=n(27461),M=n(45332),D=n(27226),I=n(22379);function P(e,t,n,r,o,s,a){try{var i=e[s](a),l=i.value}catch(c){return void n(c)}i.done?t(l):Promise.resolve(l).then(r,o)}function F(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var s=e.apply(t,n);function a(e){P(s,r,o,a,i,"next",e)}function i(e){P(s,r,o,a,i,"throw",e)}a(void 0)}))}}function T(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function q(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){T(e,t,n[t])}))}return e}var W=function(e){var t,n,r,x,P=e.id,T=e.username,W=e.userData,R=(e.otherUsers,(0,w.u)(E.d).useListOfJobs),V=(0,w.u)(L.V),H=V.setModalState,z=(V.setQuery,V.query),Q=V.setQueryVal,J=V.setTempQuery,X=V.fullWidth,G=(0,S.aC)(),K=G.userInfo,Y=G.modCheck,$=(0,A.Z)(W),ee=$.handleFollow,te=$.followed,ne=(0,b.useRouter)(),re=(0,j.useMediaQuery)({maxWidth:768}),oe=(0,a.useState)(!0),se=oe[0],ae=oe[1],ie=R({defaultSort:"hot",initialSettings:q({jobStatus:"completed",userId:P},P===(null===K||void 0===K?void 0:K.id)?{isPublished:"true"}:{},{orderBy:(null===(t=ne.query)||void 0===t?void 0:t.sort)||"hot",minRankingScore:"0"})});(0,a.useEffect)((function(){var e,t,n;(null===(e=ne.query)||void 0===e||null===(t=e.search)||void 0===t?void 0:t.length)>0&&(ie.settings.prompt=(null===(n=ne.query)||void 0===n?void 0:n.search)||null);return setTimeout((function(){return ie.firstLoad()}),1),function(){Q(""),J("")}}),[]),(0,a.useEffect)((function(){ie.jobsList.length>0&&H((function(e){return q({},e,{jobDataArray:ie.jobsList,jobDataArrayCache:ie.jobsList})}))}),[ie.jobsList,H]),(0,a.useEffect)((function(){ie.isFirstRun||ie.settings.prompt===z&&!!ie.settings.prompt===!!z||(z&&(ie.settings.prompt=z),ie.search())}),[ie.isFirstRun,ie.settings.prompt,z]);var le=(0,a.useState)(!1),ce=le[0],ue=le[1],de=(0,a.useMemo)((function(){return[re&&{title:"View archive",link:"/app/users/".concat(P,"/archive"),icon:(0,s.jsx)(l.Z,{height:18})},re&&{title:te?"Unfollow":"Follow",warn:te,onClick:ee,icon:te?(0,s.jsx)(c.Z,{height:"16",className:""}):(0,s.jsx)(u.Z,{height:"16",className:""}),slug:"follow"},re&&Y("moderator")&&{title:"break-9"},Y("moderator")&&{title:"Mod Actions",disabled:!0,icon:(0,s.jsx)(d.Z,{height:"16",className:""}),optionArray:[{title:"Copy ID",onClick:function(){return v()(P)},icon:(0,s.jsx)(f.Z,{height:"16"}),slug:"copy-userid"},{title:"Contact",onClick:function(){var e=prompt("What is your message for ".concat(T,"?"));e&&fetch("/api/app/users/mod-contact",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:P,message:e.trim()})}).then(function(){var e=F(o().mark((function e(t){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.json();case 2:!(null===(n=e.sent)||void 0===n?void 0:n.error)&&t.ok?(0,D.z)("Message sent!"):(0,D.x)("Message failed to send: ".concat(t.status," ").concat((null===n||void 0===n?void 0:n.error)||t.statusText," (").concat(n.trace,")"));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){(0,D.x)("Error sending message: ".concat(e))}))},icon:(0,s.jsx)(i,{height:"16",className:""})},Y("community")&&{title:"Wipe User",danger:!0,onClick:function(){confirm("Are you sure you want to wipe all jobs for ".concat(T,"?"))&&confirm("Absolutely, 100% super-duper sure you want to wipe all jobs for ".concat(T,"?"))&&fetch("/api/mod/wipe-user",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:P})}).then((function(e){200===e.status?(0,D.z)("User wiped! Reload the page to see changes."):(0,D.x)("Something went wrong: : ".concat(e.status," ").concat(e.statusText))})).catch((function(e){(0,D.x)("Something went wrong: ".concat(e))}))},icon:(0,s.jsx)(h.Z,{height:"16",className:""})}].filter(Boolean)}].filter(Boolean)}),[te,ee,P,re,Y,T]),fe=(0,a.useMemo)((function(){return(0,s.jsxs)(s.Fragment,{children:[!re&&(0,s.jsxs)(k.Z,{href:"/app/users/".concat(P,"/archive"),className:"group min-w-max max-w-max !font-bold !px-6 text-darkBlue-500 rounded-full .border-2 bg-slate-300 hover:!bg-slate-200 flex gap-2 items-center justify-center !bg-opacity-100",children:[(0,s.jsx)(l.Z,{height:18})," ",(0,s.jsx)("span",{className:"hidden md:inline",children:"Archive"})]},"archive"),!re&&(0,s.jsx)(N.Z,{onClick:function(){ue(!0),ee()},onMouseLeave:function(){return ue(!1)},className:"group-button min-w-max max-w-max !font-bold !px-6 text-darkBlue-500 rounded-full .border-2 bg-slate-300  flex gap-2 items-center justify-center !bg-opacity-100 ".concat(te&&!ce?" hover:border-red-700 hover:text-red-200 hover:!bg-red-900 ":"hover:!bg-slate-200"),children:te?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:ce?"flex":"flex [.group-button:hover_&]:hidden",children:"Following"}),(0,s.jsx)("span",{className:ce?"hidden":"hidden [.group-button:hover_&]:flex relative before:text-transparent before:content-['Following']",children:(0,s.jsx)("span",{className:"absolute centerAbs",children:"Unfollow"})})]}):(0,s.jsx)("span",{className:"flex relative before:text-transparent before:content-['Following']",children:(0,s.jsxs)("span",{className:"flex absolute justify-center items-center centerAbs",children:[(0,s.jsx)(u.Z,{height:18,className:"mr-2 inline"}),"Follow"]})})},"followButton"),re||Y("moderator")&&(0,s.jsx)(C.Z,{optionArray:de,maxWidth:"!w-max",placement:"top-end",className:"h-full",offset:[0,10],transformOrigin:"top-right",buttonHoverStyle:"!rounded-full",children:(0,s.jsx)(N.Z,{className:(0,M.CN)("group aspect-square md:text-darkBlue-500 rounded-full .border-2 bg-slate-100/5  md:bg-slate-300 md:hover:!bg-slate-200 flex gap-2 items-center justify-center !bg-opacity-100"),children:(0,s.jsx)(m.Z,{height:re?18:24})},"options")})]})}),[de,ce,te,ee,P,re,Y]),he=(0,a.useMemo)((function(){var e;return(null===W||void 0===W?void 0:W.created)?"".concat(null===(e=(0,M.L0)(new Date(null===W||void 0===W?void 0:W.created),!0)[1])||void 0===e?void 0:e.replace(" 2022","").replace(",","")):"Unknown"}),[null===W||void 0===W?void 0:W.created]);return(0,s.jsxs)(B.o,{title:T||"User",fullWidth:X,className:M.VU,icon:(0,s.jsx)(I.Avatar,{user:P,avatar:W.avatar_job_id,size:32}),meta:(0,s.jsx)(U.h,{title:"".concat(T,"'s Gallery"),description:"All the images generated by ".concat(P," in the public Midjourney channels")}),children:[(0,s.jsx)(I.UserBanner,{bannerUrl:"https://mj-gallery.com/".concat((null===W||void 0===W?void 0:W.cover_job_id)||(null===(n=ie.jobsList)||void 0===n||null===(r=n[0])||void 0===r?void 0:r.id),"/grid_0.webp"),username:T,children:(0,s.jsx)(I.UserBannerInfo,{avatar:W.avatar_job_id,tagline:(0,s.jsx)("p",{children:(0,s.jsxs)("span",{className:"text-slate-500",children:["User since ",he]})}),user:W,username:T,customButtons:fe})}),se&&(0,s.jsxs)("div",{className:"flex relative flex-col gap-4 md:px-4 mt-4 md:mt-2 mb-6 w-full xl:my-6",children:[(0,s.jsxs)("div",{className:"flex justify-between px-2 -mb-3 w-full text-base",children:[(0,s.jsx)("p",{className:"font-medium text-slate-400"}),(0,s.jsx)(g.default,{href:"/app/users/".concat(P,"/collections"),children:(0,s.jsxs)("a",{href:"",className:"text-slate-500 hover:text-slate-300",children:["View all collections"," ",(0,s.jsx)(p.Z,{height:18,className:"inline -rotate-45"})]})})]}),(0,s.jsx)(y.Z,{userId:P,home:!0,hideCallback:function(){return ae(!1)},className:"overflow-x-scroll gap-4 py-2 w-full miniScrollbar",buttonClassName:"md:basis-1 max-w-[50%] md:max-w-[33%]",showAddButton:!1,maxItems:4,publicDisplay:!0})]}),(0,s.jsx)(Z.x,{fixedData:ie}),(0,s.jsx)(O.H,{query:null===(x=ne.query)||void 0===x?void 0:x.jobId,returnHref:"/app/users/".concat(P)}),(0,s.jsx)(_.Z,{fixedData:ie,settings:{dedupe:!1}})]})};W.getInitialProps=function(){var e=F(o().mark((function e(t){var n,r,s,a,i,l,c,u,d,f;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,fetch("".concat("https://www.midjourney.com","/api/app/users/?userIds=").concat(t.query.user),{headers:{Cookie:null===(n=t.req)||void 0===n?void 0:n.headers.cookie}});case 3:return a=e.sent,e.next=6,a.json();case 6:return i=e.sent,{},i.length-1,l=[null===(r=i[0])||void 0===r?void 0:r.user_id,null===(s=i[0])||void 0===s?void 0:s.username],u=l[1],(c=l[0])&&u||(null===(d=t.res)||void 0===d||d.writeHead(302,{Location:"/404"}),null===(f=t.res)||void 0===f||f.end()),e.abrupt("return",{id:c,username:u,userData:i[0],otherUsers:i});case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();var R=W}},function(e){e.O(0,[2962,6168,1852,3735,6269,4240,1302,5428,447,210,9774,2888,179],(function(){return t=51367,e(e.s=t);var t}));var t=e.O();_N_E=t}]);